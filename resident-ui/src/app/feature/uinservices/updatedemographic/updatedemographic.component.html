<span class="breadcrumb breadcrumb-two">
  <a (click)="onItemSelected('uinservices/dashboard')">{{'dashboard.uinservices' | translate}} &nbsp;&nbsp;</a> >
  &nbsp;&nbsp;<span style="cursor: pointer;"
    (click)="onItemSelected('uinservices/updatedemographic')">{{'updatedemographic.title' | translate}}</span>
  <span [ngClass]="!showPreviewPage ? 'active' : 'demographic'" (click)="onItemSelected('matTabLabel')">&nbsp; > &nbsp;
    {{matTabLabel}}</span>
  &nbsp;&nbsp;<span *ngIf="showPreviewPage" class="active">&nbsp; > &nbsp; {{'preview.title' | translate}}</span>
</span>
<div class="spinner" *ngIf="isLoading">
  <mat-spinner></mat-spinner>
</div>
<div *ngIf="!isLoading && langJson" class="main-contianer">
  <mat-card *ngIf="userInfo && !showPreviewPage && (buildJSONData | json) != '{}'">
    <h1 style="font-weight: 500; font-size: 20px;color: #505050;">{{langJson.title}}</h1>
    <mat-tab-group animationDuration="0ms" [selectedIndex]="matTabIndex" (selectedTabChange)="logChange($event)">
      <mat-tab label="{{'updatedemographic.identity' | translate}}">
        <h3 class="tab-headings">{{'updatedemographic.identityHeading' | translate}}</h3>
        <table class="each-tab-group-main-table">
          <tr class="table-main-card">
            <td class="main-table-data">
              <div *ngFor="let field of schema['identity']; let idx = index" class="mat-form1">
                <div layout="row" *ngIf="field.tabgroup === 'identity'">
                  <table width="100%">
                    <tr *ngIf="field.controlType === 'calendar'">
                      <td width="100%" class="main-table-data">
                        <table width="100%">
                          <tr>
                            <td class="width-of-input"><label>{{field.labelName[langCode][0]}}</label></td>
                            <td width="3%"></td>
                            <td class="width-of-input"><label>{{field.labelName[langCode][1]}}</label></td>
                          </tr>
                          <tr>
                            <td class="width-of-input"><input type="text" class="readonly" readonly="true"
                                disabled="true" [value]="buildJSONData[field.attributeName].value"></td>
                            <td width="3%"></td>
                            <td class="width-of-input">
                              <div class="date-input-card" *ngIf="langJson">
                                <input [disabled]="attributeUpdateCountRemainLimit[field.attributeName] === 0" [max]="maxdate" style=" border: none;" matInput
                                  [placeholder]="langJson.calendarPlaceHolder" [matDatepicker]="picker" readonly
                                  id="{{field.attributeName}}"
                                  (dateChange)="captureDatePickerValue($event, field.attributeName, buildJSONData[field.attributeName])"
                                  [(ngModel)]="selectedDate" (click)="picker.open()" />
                                <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
                                <mat-datepicker #picker></mat-datepicker>
                              </div>
                              <p class="warning-message"
                                *ngIf="userInputValues[field.attributeName] === buildJSONData[field.attributeName]">
                                {{langJson.sameDobInputErrorMsg}}</p>
                            </td>
                            <td width="1%"></td>
                            <td *ngIf="attributeUpdateCountRemainLimit" class="number-of-attems-main-card">
                              <div class="number-of-attems-left-card">
                                <div class="number-of-attems-arrow-shape"></div>
                                <div>
                                  <span
                                    style="display: block; font-weight: 600;">{{langJson.remainingAttems.replace("$remainingAttems",
                                    attributeUpdateCountRemainLimit[field.attributeName])}}</span>
                                  <span style="display: block;">{{langJson.maxAttems.replace("$maxAttems",
                                    attributeUpdateCountMaxLimit[field.attributeName])}}</span>
                                </div>
                              </div>
                            </td>
                          </tr>
                        </table>
                      </td>
                    </tr>
                    <tr *ngIf="field.controlType === 'textbox'">
                      <td class="main-table-data" width="100%">
                        <table width="100%" *ngFor="let language of supportedLanguages;">
                          <tr>
                            <td class="width-of-input"><label>{{field.labelName[langCode][0]}}</label></td>
                            <td width="3%"></td>
                            <td class="width-of-input"><label>{{field.labelName[langCode][1]}}</label></td>
                          </tr>
                          <tr *ngFor="let item of buildJSONData[field.attributeName], let i = index">
                            <td class="sub-table-row" class="width-of-input" class="each-input-data"
                              [ngClass]="item.language === 'ara' ? 'dir-rtl' :'dir-ltl'">
                              <input type="text" class="readonly" readonly="true" disabled="true" [value]="item.value">
                            </td>
                            <td class="sub-table-row" width="3%"></td>
                            <td class="sub-table-row">
                              <div class="search-input-card" [ngClass]="item.language === 'ara' ? 'dir-rtl' :'dir-ltl'">
                                <input class="input" matInput #{{field.attributeName}}
                                  id="{{field.attributeName}}{{item.language}}"
                                  (blur)="captureValue($event, field.attributeName, item.language, item.value)"
                                  placeholder="{{field.placeHolder[item.language]}}"
                                  [value]="userInputValues[field.attributeName][item.language]"
                                  (focus)="captureVirtualKeyboard(field.attributeName + item.language, item.index)"
                                  [disabled]="attributeUpdateCountRemainLimit[field.attributeName] === 0"
                                  #keyboardRef />
                                <i matSuffix class="material-icons mat-keyboard-icon"
                                  (click)="openKeyboard(field.attributeName+item.language, item.language)">keyboard</i>
                              </div>
                              <span
                                *ngIf="userInputValues[field.attributeName] && i === (buildJSONData[field.attributeName]?.length -1) && buildJSONData[field.attributeName][0].value">
                                <p class="warning-message"
                                  *ngIf="userInputValues[field.attributeName] === buildJSONData[field.attributeName][0].value">
                                  {{langJson.sameNameInputErrorMsg}}</p>
                              </span>
                            </td>
                            <td class="sub-table-row" width="1%"></td>
                            <td *ngIf="i===0 && attributeUpdateCountRemainLimit" class="number-of-attems-main-card">
                              <div [ngClass]="attributeUpdateCountRemainLimit[field.attributeName] <= 0 ? 'low-number-of-attems-left-card' : 'number-of-attems-left-card'" class="number-of-attems-left-card">
                                <div [ngClass]="attributeUpdateCountRemainLimit[field.attributeName] <= 0 ? 'low-number-of-attems-arrow-shape':'number-of-attems-arrow-shape'" class="number-of-attems-arrow-shape"></div>
                                <div>
                                  <span
                                    style="display: block; font-weight: 600;">{{langJson.remainingAttems.replace("$remainingAttems",attributeUpdateCountRemainLimit[field.attributeName])}}</span>
                                  <span *ngIf="attributeUpdateCountMaxLimit" style="display: block;">{{langJson.maxAttems.replace("$maxAttems",
                                    attributeUpdateCountMaxLimit[field.attributeName])}}</span>
                                </div>
                              </div>
                            </td>
                          </tr>
                        </table>
                      </td>
                    </tr>
                    <tr *ngIf="field.controlType === 'dropdown'">
                      <td class="main-table-data" width="100%">
                        <table width="100%">
                          <tr>
                            <td class="width-of-input"><label>{{field.labelName[langCode][0]}}</label></td>
                            <td width="3%"></td>
                            <td class="width-of-input"><label>{{field.labelName[langCode][1]}}</label></td>
                          </tr>
                          <tr *ngFor="let item of buildJSONData[field.attributeName], let i = index">
                            <td class="sub-table-row width-of-input"
                              [ngClass]="item.language === 'ara' ? 'dir-rtl' :'dir-ltl'">
                              <input type="text" class="readonly" readonly="true" disabled="true" [value]="item.value">
                            </td>
                            <td width="3%" class="sub-table-row"></td>
                            <td class="sub-table-row width-of-input">
                              <span [ngClass]="item.language === 'ara' ? 'dir-rtl' :'dir-ltl'">
                                <mat-select disableOptionCentering class="enable-dropdown" id="{{field.attributeName}}"
                                  placeholder="{{field.placeHolder[item.language]}}"
                                  [(value)]="userInputValues[field.attributeName][item.language]"
                                  [disabled]="attributeUpdateCountRemainLimit[field.attributeName] === 0"
                                  (selectionChange)="captureDropDownValue($event, field.attributeName, item.language)">
                                  <mat-option *ngFor="let data of dropDownValues[field.attributeName][item.language]"
                                    [value]="data.code">{{ data.value }}</mat-option>
                                </mat-select>
                              </span>
                              <span
                                *ngIf="userInputValues[field.attributeName] && i === (buildJSONData[field.attributeName]?.length -1)">
                                <p class="warning-message"
                                  *ngIf="userInputValues[field.attributeName] === buildJSONData[field.attributeName][langCode]">
                                  {{langJson.sameGenderInputErrorMsg}}</p>
                              </span>
                            </td>
                            <td class="sub-table-row" width="1%"></td>
                            <td *ngIf="i===0 && attributeUpdateCountRemainLimit" class="number-of-attems-main-card">
                              <div class="number-of-attems-left-card">
                                <div class="number-of-attems-arrow-shape"></div>
                                <div>
                                  <span
                                    style="display: block; font-weight: 600;">{{langJson.remainingAttems.replace("$remainingAttems",
                                    attributeUpdateCountRemainLimit[field.attributeName])}}</span>
                                  <span style="display: block;">{{langJson.maxAttems.replace("$maxAttems",
                                    attributeUpdateCountMaxLimit[field.attributeName])}}</span>
                                </div>
                              </div>
                            </td>
                          </tr>
                        </table>
                      </td>
                    </tr>
                    <tr *ngIf="field.controlType === 'fileupload'">
                      <td class="main-table-data">
                        <table class="file-Upload-card">
                          <tr>
                            <td width="100%" colspan="3"><label>{{field.labelName[langCode][0]}}</label></td>
                          </tr>
                          <tr>
                            <td class="width-of-input"><label>{{field.labelName[langCode][1]}}<span
                                  style="color: red;">*</span></label></td>
                            <td width="3%"></td>
                            <td class="width-of-input"><label>{{field.labelName[langCode][2]}}</label></td>
                          </tr>
                          <tr>
                            <td class="width-of-input">
                              <mat-select disableOptionCentering class="enable-dropdown"
                                [value]="proofOfIdentity['documenttype'] ? proofOfIdentity['documenttype'] : '' "
                                id="{{field.attributeName}}">
                                <mat-option style="min-width: 25.2rem;"
                                  *ngFor="let data of dropDownValues[field.attributeName]"
                                  (onSelectionChange)="captureDropDownValue($event, field.attributeName, supportedLanguages[0], field.dataType)"
                                  [value]="data.code">{{ data.name }}</mat-option>
                              </mat-select>
                            </td>
                            <td width="3%"></td>
                            <td class="width-of-input">
                              <div class="search-input-card">
                                <input class="input"
                                  [value]="proofOfIdentity['documentreferenceId'] ? proofOfIdentity['documentreferenceId'] : '' "
                                  matInput #{{field.attributeName}} id="{{field.attributeName}}value"
                                  (blur)="captureValue($event, field.attributeName, '', '')"
                                  (focus)="captureVirtualKeyboard(field.attributeName + 'value', buildJSONData.proofOfIdentity)"
                                  #keyboardRef />
                                <i matSuffix class="material-icons mat-keyboard-icon"
                                  (click)="openKeyboard(field.attributeName +'value')">keyboard</i>
                              </div>
                            </td>
                          </tr>
                          <tr *ngIf="displayPOIUpload">
                            <td width="100%" colspan="3"><label>{{field.labelName[langCode][3]}}<span
                                  style="color: red;">*</span></label></td>
                          </tr>
                          <tr *ngIf="displayPOIUpload">
                            <td width="100%" colspan="3">
                              <div class="container" appDnd (fileDropped)="onFileDropped($event, 'POI')">
                                <input (click)="$event.target.value=null"
                                  [disabled]="proofOfIdentity.documenttype === undefined || files?.length === 1 "
                                  type="file" #fileDropRef id="fileDropRef"
                                  (change)="fileBrowseHandler($event.target.files, 'POI')"
                                  accept=".pdf, .jpg, .jpeg, .png" />
                                <label style="margin-right: 1rem;display: flex;" for="fileDropRef">
                                  <svg id="upload_icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24.042"
                                    viewBox="0 0 24 24.042">
                                    <g id="Group_13" data-name="Group 13" transform="translate(3 2.504)">
                                      <path id="Path_988" data-name="Path 988"
                                        d="M13,11.337l2.59,2.585L17,12.509,12,7.5,7,12.509l1.41,1.412L11,11.337v9.687h2Z"
                                        transform="translate(-3 -7.5)" fill="#03a64a" />
                                      <path id="Path_2004" data-name="Path 2004"
                                        d="M19,3v7.012H5V3H3v7.012a2.008,2.008,0,0,0,2,2H19a2.008,2.008,0,0,0,2-2V3Z"
                                        transform="translate(-3 6.517)" fill="#03a64a" />
                                    </g>
                                    <path id="Path_989" data-name="Path 989" d="M0,24.042H24V0H0Z" fill="none" />
                                  </svg>
                                  <span
                                    style="margin-top: 4px;padding-left: 5px; font-size: 14px; font-weight: 600;">{{langJson.uploadImage}}</span>
                                </label>
                                <h3>{{langJson.or}}</h3>
                                &nbsp;
                                <h3>{{langJson.dropImage}}</h3>
                              </div>
                              <p *ngIf="isValidFileFormatPOI" class="warning-message">{{warningMessage}}</p>
                            </td>
                          </tr>
                          <tr *ngIf="displayPOIUpload">
                            <td width="100%" colspan="3">
                              <label style="display: block;">{{field.labelName[langCode][4]}}</label>
                              <label>{{field.labelName[langCode][5]}}</label>
                            </td>
                          </tr>
                          <tr>
                            <td width="100%" colspan="3">
                              <div class="files-list">
                                <div class="single-file" *ngFor="let file of files; let i = index">
                                  <div class="file-icon" style="width: 50px">
                                    <svg version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg"
                                      xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 58 58"
                                      style="enable-background:new 0 0 58 58;" xml:space="preserve">
                                      <polygon style="fill:#EDEADA;" points="51.5,14 37.5,0 6.5,0 6.5,58 51.5,58 " />
                                      <g>
                                        <path style="fill:#CEC9AE;"
                                          d="M16.5,23h25c0.552,0,1-0.447,1-1s-0.448-1-1-1h-25c-0.552,0-1,0.447-1,1S15.948,23,16.5,23z" />
                                        <path style="fill:#CEC9AE;"
                                          d="M16.5,15h10c0.552,0,1-0.447,1-1s-0.448-1-1-1h-10c-0.552,0-1,0.447-1,1S15.948,15,16.5,15z" />
                                        <path style="fill:#CEC9AE;"
                                          d="M41.5,29h-25c-0.552,0-1,0.447-1,1s0.448,1,1,1h25c0.552,0,1-0.447,1-1S42.052,29,41.5,29z" />
                                        <path style="fill:#CEC9AE;"
                                          d="M41.5,37h-25c-0.552,0-1,0.447-1,1s0.448,1,1,1h25c0.552,0,1-0.447,1-1S42.052,37,41.5,37z" />
                                        <path style="fill:#CEC9AE;"
                                          d="M41.5,45h-25c-0.552,0-1,0.447-1,1s0.448,1,1,1h25c0.552,0,1-0.447,1-1S42.052,45,41.5,45z" />
                                      </g>
                                      <polygon style="fill:#CEC9AE;" points="37.5,0 37.5,14 51.5,14 " />
                                    </svg>
                                  </div>
                                  <div class="info">
                                    <h4 class="name">
                                    </h4>
                                    <p class="size">
                                      {{ formatBytes(file?.size) }}
                                    </p>
                                    {{file?.name}}
                                    <app-progress [progress]="file?.progress"></app-progress>
                                  </div>

                                  <div class="preview">
                                    <img (click)="previewFile(i, 'POI')" mat-card-xs-image style="margin: 0 0 -5px 0;"
                                      src='./assets/icons/iconfont/visibility_on.svg' alt="" />
                                  </div>

                                  <div class="delete" (click)="deleteFile(i, 'POI')">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="14" height="18" viewBox="0 0 14 18">
                                      <path fill="#B1B1B1" fill-rule="nonzero"
                                        d="M1 16c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2H3c-1.1 0-2 .9-2 2v10zm3.17-7.83a.996.996 0 0 1 1.41 0L7 9.59l1.42-1.42a.996.996 0 1 1 1.41 1.41L8.41 11l1.42 1.42a.996.996 0 1 1-1.41 1.41L7 12.41l-1.42 1.42a.996.996 0 1 1-1.41-1.41L5.59 11 4.17 9.58a.996.996 0 0 1 0-1.41zM10.5 1L9.79.29C9.61.11 9.35 0 9.09 0H4.91c-.26 0-.52.11-.7.29L3.5 1H1c-.55 0-1 .45-1 1s.45 1 1 1h12c.55 0 1-.45 1-1s-.45-1-1-1h-2.5z" />
                                    </svg>
                                  </div>
                                </div>
                              </div>
                            </td>
                          </tr>
                        </table>
                      </td>
                    </tr>
                  </table>
                </div>
              </div>
            </td>
          </tr>
        </table>
        <div class="submit-btn-card">
          <button [disabled]="previewDisabled" (click)="previewBtn('identity')" mat-raised-button color="primary"
            id="submit">{{langJson.preview}}</button>
        </div>
      </mat-tab>
      <mat-tab label="{{'updatedemographic.address' | translate}}">
        <h3 class="tab-headings">{{'updatedemographic.addressHeading' | translate}}</h3>
        <div class="address-page">
          <table class="file-Upload-card">
            <tr class="table-main-card">
              <td>
                <div *ngFor="let field of schema['identity']; let i = index" class="mat-form1">
                  <div layout="row" *ngIf="field.tabgroup === 'address'">
                    <table width="100%">
                      <tr *ngIf="field.controlType === 'textbox'">
                        <td class="main-table-data" width="100%">
                          <table width="100%" *ngFor="let language of supportedLanguages;">
                            <tr>
                              <td class="width-of-input"><label>{{field.labelName[langCode][0]}}</label></td>
                              <td width="3%"></td>
                              <td class="width-of-input"><label>{{field.labelName[langCode][1]}}</label></td>
                            </tr>
                            <tr *ngFor="let item of buildJSONData[field.attributeName] let i = index"
                              [ngClass]="item.language === 'ara' ? 'dir-rtl' :'dir-ltl'">
                              <td class="sub-table-row" class="width-of-input">
                                <input *ngIf="buildJSONData[field.attributeName]" type="text" class="readonly"
                                  readonly="true" disabled="true" [value]="item.value">
                              </td>
                              <td class="sub-table-row" width="3%"></td>
                              <td class="sub-table-row" class="width-of-input">
                                <div class="search-input-card">
                                  <input class="input" matInput #{{field.attributeName}}
                                    id="{{field.attributeName}}{{item.language}}"
                                    (blur)="captureAddressValue($event, field.attributeName, item.language)"
                                    [(value)]="userInputValues[field.attributeName][item.language]"
                                    [placeholder]="field.placeHolder[item.language]"
                                    (focus)="captureVirtualKeyboard(field.attributeName+item.language, item.index)"
                                    #keyboardRef />
                                  <i matSuffix class="material-icons mat-keyboard-icon"
                                    (click)="openKeyboard(field.attributeName+item.language, item.language)">keyboard</i>
                                </div>
                              </td>
                            </tr>
                          </table>
                        </td>
                      </tr>
                      <tr *ngIf="field.controlType === 'dropdown'">
                        <td class="main-table-data" width="100%">
                          <table width="100%">
                            <tr>
                              <td class="width-of-input"><label>{{field.labelName[langCode][0]}}</label></td>
                              <td width="3%"></td>
                              <td class="width-of-input"><label>{{field.labelName[langCode][1]}}</label></td>
                            </tr>
                            <ng-container *ngIf="typeOf(userInfo[field.attributeName]) !== 'string'">
                              <tr *ngFor="let item of buildJSONData[field.attributeName], let i = index">
                                <td class="sub-table-row each-Hierarchy-td width-of-input">
                                  <input *ngIf="buildJSONData[field.attributeName]"  type="text" class="readonly"
                                    readonly="true" disabled="true" [value]="item.value">
                                </td>
                                <td class="sub-table-row" width="3%"></td>
                                <td  class="sub-table-row each-Hierarchy-td width-of-input"
                                *ngIf="dynamicDropDown[field.name]">
                                <span [ngClass]="item.language === 'ara' ? 'dir-rtl' :'dir-ltl'">
                                  <mat-select disableOptionCentering
                                    placeholder="{{field.placeHolder[item.language]}}"
                                    [ngClass]="dynamicDropDown[field.name]?.length === 0 ? 'disable-dropdown' : 'enable-dropdown'"
                                    [(value)]="userInputValues[field.attributeName][item.language]"
                                    id="{{field.name}}{{item.language}}"
                                    (selectionChange)="loadLocationDataDynamically($event, field.locationHierarchyLevel,field.attributeName,typeOf(userInfo[field.attributeName]))">
                                    <mat-option *ngFor="let data of dynamicDropDown[field.name][item.language]" [value]="data.code">
                                      {{ data.name }}
                                    </mat-option>
                                  </mat-select>
                                </span>
                                  <span *ngIf="locationFieldNameList?.length">
                                    <p *ngIf="locationFieldNameList[field.locationHierarchyLevel-1] === fieldName && i === (buildJSONData[field.attributeName]?.length -1)"
                                      class="warning-message">{{langJson.EnterAllAddress}} {{fieldName}}</p>
                                  </span>
                                </td>
                              </tr>
                            </ng-container>
                            <tr *ngIf="typeOf(userInfo[field.attributeName]) === 'string'">
                              <td *ngIf="buildJSONData[field.attributeName]" class="width-of-input">
                                <input type="text" class="readonly" readonly="true" disabled="true"
                                  [value]="buildJSONData[field.attributeName].value">
                              </td>
                              <td class="sub-table-row" width="3%"></td>
                              <td class="sub-table-row each-Hierarchy-td" class="width-of-input"
                                *ngIf="dynamicDropDown[field.name]">
                                <mat-select disableOptionCentering
                                  placeholder="{{langJson.select}} {{field.labelName[langCode][1]}}"
                                  [ngClass]="dynamicDropDown[field.name]?.length === 0 ? 'disable-dropdown' : 'enable-dropdown'"
                                  [(value)]="userInputValues[field.attributeName]" id="{{field.name}}"
                                  (selectionChange)="loadLocationDataDynamically($event, field.locationHierarchyLevel,field.attributeName,typeOf(userInfo[field.attributeName]))">
                                  <mat-option *ngFor="let data of dynamicDropDown[field.name].eng" [value]="data.code">
                                    {{ data.name }}
                                  </mat-option>
                                </mat-select>
                                <span *ngIf="locationFieldNameList?.length">
                                  <p *ngIf="locationFieldNameList[field.locationHierarchyLevel-1] === fieldName"
                                    class="warning-message">{{langJson.EnterAllAddress}} {{fieldName}}</p>
                                </span>
                              </td>
                            </tr>
                          </table>
                        </td>
                      </tr>
                      <tr *ngIf="field.controlType === 'fileupload'">
                        <td class="main-table-data" width="100%">
                          <table>
                            <tr>
                              <td width="100%" colspan="3"><label>{{field.labelName[langCode][0]}}</label></td>
                            </tr>
                            <tr>
                              <td class="width-of-input"><label>{{field.labelName[langCode][1]}}<span
                                    style="color: red;">*</span></label></td>
                              <td width="3%"></td>
                              <td class="width-of-input"><label>{{field.labelName[langCode][2]}}</label></td>
                            </tr>
                            <tr>
                              <td class="width-of-input">
                                <mat-select disableOptionCentering class="enable-dropdown"
                                  [value]="proofOfAddress['documenttype'] ? proofOfAddress['documenttype'] : '' "
                                  id="{{field.attributeName}}">
                                  <mat-option style="min-width: 25.2rem;"
                                    *ngFor="let data of dropDownValues[field.attributeName]"
                                    (onSelectionChange)="captureAddressDropDownValue($event, field.attributeName)"
                                    [value]="data.code">{{
                                    data.name }}</mat-option>
                                </mat-select>
                              </td>
                              <td width="3%"></td>
                              <td class="width-of-input">
                                <div class="search-input-card">
                                  <input class="input"
                                    [value]="proofOfAddress['documentreferenceId'] ? proofOfAddress['documentreferenceId'] : '' "
                                    matInput #{{field.attributeName}} id="{{field.attributeName}}value"
                                    (blur)="captureAddressValue($event, field.attributeName, '')"
                                    (focus)="captureVirtualKeyboard(field.attributeName, buildJSONData.proofOfAddress)"
                                    #keyboardRef />
                                  <i matSuffix class="material-icons mat-keyboard-icon"
                                    (click)="openKeyboard(field.attributeName+'value')">keyboard</i>
                                </div>
                              </td>
                            </tr>
                            <tr *ngIf="displayPOAUpload">
                              <td width="100%" colspan="3"><label>{{field.labelName[langCode][3]}}<span
                                    style="color: red;">*</span></label></td>
                            </tr>
                            <tr *ngIf="displayPOAUpload">
                              <td width="100%" colspan="3">
                                <div class="container" appDnd (fileDropped)="onFileDropped($event, 'POA')">
                                  <input (click)="$event.target.value=null"
                                    [disabled]="proofOfAddress.documenttype === undefined || filesPOA?.length === 1"
                                    type="file" #fileAddRef id="fileAddRef"
                                    (change)="fileBrowseHandler($event.target.files, 'POA')"
                                    accept=".pdf, .jpg, .jpeg, .png" />
                                  <label style="margin-right: 1rem;display: flex;" for="fileAddRef">
                                    <svg id="upload_icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24.042"
                                      viewBox="0 0 24 24.042">
                                      <g id="Group_13" data-name="Group 13" transform="translate(3 2.504)">
                                        <path id="Path_988" data-name="Path 988"
                                          d="M13,11.337l2.59,2.585L17,12.509,12,7.5,7,12.509l1.41,1.412L11,11.337v9.687h2Z"
                                          transform="translate(-3 -7.5)" fill="#03a64a" />
                                        <path id="Path_2004" data-name="Path 2004"
                                          d="M19,3v7.012H5V3H3v7.012a2.008,2.008,0,0,0,2,2H19a2.008,2.008,0,0,0,2-2V3Z"
                                          transform="translate(-3 6.517)" fill="#03a64a" />
                                      </g>
                                      <path id="Path_989" data-name="Path 989" d="M0,24.042H24V0H0Z" fill="none" />
                                    </svg>
                                    <span
                                      style="margin-top: 4px;padding-left: 5px; font-size: 14px; font-weight: 600;">{{langJson.uploadImage}}</span>
                                  </label>
                                  <h3>{{langJson.or}}</h3>
                                  &nbsp;
                                  <h3>{{langJson.dropImage}}</h3>
                                </div>
                                <p *ngIf="isValidFileFormatPOA" class="warning-message">{{warningMessage}}</p>
                              </td>
                            </tr>
                            <tr *ngIf="displayPOAUpload">
                              <td width="100%" colspan="3">
                                <label style="display: block;">{{field.labelName[langCode][4]}}</label>
                                <label>{{field.labelName[langCode][5]}}</label>
                              </td>
                            </tr>
                            <tr>
                              <td width="100%" colspan="3">
                                <div class="files-list">
                                  <div class="single-file" *ngFor="let file of filesPOA; let i = index">
                                    <div class="file-icon" style="width: 50px">
                                      <svg version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg"
                                        xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 58 58"
                                        style="enable-background:new 0 0 58 58;" xml:space="preserve">
                                        <polygon style="fill:#EDEADA;" points="51.5,14 37.5,0 6.5,0 6.5,58 51.5,58 " />
                                        <g>
                                          <path style="fill:#CEC9AE;"
                                            d="M16.5,23h25c0.552,0,1-0.447,1-1s-0.448-1-1-1h-25c-0.552,0-1,0.447-1,1S15.948,23,16.5,23z" />
                                          <path style="fill:#CEC9AE;"
                                            d="M16.5,15h10c0.552,0,1-0.447,1-1s-0.448-1-1-1h-10c-0.552,0-1,0.447-1,1S15.948,15,16.5,15z" />
                                          <path style="fill:#CEC9AE;"
                                            d="M41.5,29h-25c-0.552,0-1,0.447-1,1s0.448,1,1,1h25c0.552,0,1-0.447,1-1S42.052,29,41.5,29z" />
                                          <path style="fill:#CEC9AE;"
                                            d="M41.5,37h-25c-0.552,0-1,0.447-1,1s0.448,1,1,1h25c0.552,0,1-0.447,1-1S42.052,37,41.5,37z" />
                                          <path style="fill:#CEC9AE;"
                                            d="M41.5,45h-25c-0.552,0-1,0.447-1,1s0.448,1,1,1h25c0.552,0,1-0.447,1-1S42.052,45,41.5,45z" />
                                        </g>
                                        <polygon style="fill:#CEC9AE;" points="37.5,0 37.5,14 51.5,14 " />
                                      </svg>
                                    </div>
                                    <div class="info">
                                      <h4 class="name">
                                        {{ file?.name }}
                                      </h4>
                                      <p class="size">
                                        {{ formatBytes(file?.size) }}
                                      </p>
                                      <app-progress [progress]="file?.progress"></app-progress>
                                    </div>
                                    <div class="preview">
                                      <img (click)="previewFile(i, 'POA')" mat-card-xs-image style="margin: 0 0 -5px 0;"
                                        src='./assets/icons/iconfont/visibility_on.svg' alt="" />
                                    </div>
                                    <div class="delete" (click)="deleteFile(i, 'POA')">
                                      <svg xmlns="http://www.w3.org/2000/svg" width="14" height="18"
                                        viewBox="0 0 14 18">
                                        <path fill="#B1B1B1" fill-rule="nonzero"
                                          d="M1 16c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2H3c-1.1 0-2 .9-2 2v10zm3.17-7.83a.996.996 0 0 1 1.41 0L7 9.59l1.42-1.42a.996.996 0 1 1 1.41 1.41L8.41 11l1.42 1.42a.996.996 0 1 1-1.41 1.41L7 12.41l-1.42 1.42a.996.996 0 1 1-1.41-1.41L5.59 11 4.17 9.58a.996.996 0 0 1 0-1.41zM10.5 1L9.79.29C9.61.11 9.35 0 9.09 0H4.91c-.26 0-.52.11-.7.29L3.5 1H1c-.55 0-1 .45-1 1s.45 1 1 1h12c.55 0 1-.45 1-1s-.45-1-1-1h-2.5z" />
                                      </svg>
                                    </div>
                                  </div>
                                </div>
                              </td>
                            </tr>
                          </table>
                        </td>
                      </tr>
                    </table>
                  </div>
                </div>
              </td>
            </tr>
          </table>
        </div>
        <div class="submit-btn-card">
          <button [disabled]="previewDisabledInAddress || !isSelectedAllAddress" mat-raised-button
            (click)="previewBtn('address')" color="primary" id="submit">{{langJson.preview}}</button>
        </div>
      </mat-tab>
      <mat-tab label="{{'updatedemographic.contact' | translate}}">
        <h3 class="tab-headings">{{'updatedemographic.contactHeading' | translate}}</h3>
        <div *ngFor="let field of schema['identity']; let i = index" dir="{{sitealignment}}">
          <mat-grid-list *ngIf="field.tabgroup === 'contact'" [cols]="cols" rowHeight="100px" gutterSize="7px">
            <mat-grid-tile class="mat-form1" *ngIf="buildJSONData[field.attributeName]">
              <div class="mini-card" *ngIf="field.controlType === 'textbox'">
                <mat-card-header><mat-card-title>{{field.labelName[langCode][0]}}</mat-card-title></mat-card-header>
                <mat-card-subtitle><input type="text" class="readonly" readonly="true" disabled="true"
                    [value]="buildJSONData[field.attributeName].value"></mat-card-subtitle>
              </div>
            </mat-grid-tile>
            <mat-grid-tile class="mat-form1">
              <div class="mini-card" *ngIf="field.tabgroup === 'contact' && field.controlType === 'textbox'">
                <mat-card-header><mat-card-title>{{field.labelName[langCode][1]}}</mat-card-title></mat-card-header>
                <mat-card-subtitle>
                  <div class="search-input-card" *ngIf="field.attributeName === 'email'">
                    <input class="input" [value]="userIdEmail" matInput type="password" #{{field.attributeName}}
                      id="{{field.attributeName}}" (input)="captureContactValue($event, field.attributeName)"
                      [placeholder]="field.placeHolder[langCode]"
                      (blur)="captureContactValue($event, field.attributeName)"
                      (focus)="captureVirtualKeyboard(field.attributeName, buildJSONData[field.attributeName].index)"
                      #keyboardRef />
                    <i matSuffix class="material-icons mat-keyboard-icon"
                      (click)="openKeyboard(field.attributeName)">keyboard</i>
                  </div>
                  <div class="search-input-card" *ngIf="field.attributeName === 'phone'">
                    <input class="input" [value]="userIdPhone" matInput type="password" #{{field.attributeName}}
                      id="{{field.attributeName}}" (input)="captureContactValue($event, field.attributeName)"
                      [placeholder]="field.placeHolder[langCode]"
                      (blur)="captureContactValue($event, field.attributeName)"
                      (focus)="captureVirtualKeyboard(field.attributeName, buildJSONData[field.attributeName].index)"
                      #keyboardRef />
                    <i matSuffix class="material-icons mat-keyboard-icon"
                      (click)="openKeyboard(field.attributeName)">keyboard</i>
                  </div>
                </mat-card-subtitle>
              </div>
            </mat-grid-tile>
            <mat-grid-tile class="mat-form1">
              <div class="mini-card" *ngIf="field.tabgroup === 'contact' && field.controlType === 'textbox'">
                <mat-card-header><mat-card-title>{{field.labelName[langCode][2]}}</mat-card-title></mat-card-header>

                <div class="search-input-card" *ngIf="field.attributeName === 'email'">
                  <input class="input" [value]="confirmEmailContact"
                    (input)="captureConfirmValue($event,field.attributeName)"
                    (blur)="captureConfirmValue($event,field.attributeName)" [placeholder]="field.placeHolder[langCode]"
                    (focus)="captureVirtualKeyboard('confirm' + field.attributeName, buildJSONData[field.attributeName].confIndex)"
                    matInput #confirmemail #input id="confirm{{field.attributeName}}" #keyboardRef />
                  <i matSuffix class="material-icons mat-keyboard-icon"
                    (click)="openKeyboard('confirm' + field.attributeName)">keyboard</i>
                </div>
                <div class="search-input-card" *ngIf="field.attributeName === 'phone'">
                  <input class="input" [value]="confirmPhoneContact"
                    (input)="captureConfirmValue($event,field.attributeName)"
                    [placeholder]="field.placeHolder[langCode]" (blur)="captureConfirmValue($event,field.attributeName)"
                    (focus)="captureVirtualKeyboard('confirm' + field.attributeName, buildJSONData[field.attributeName].confIndex)"
                    matInput #confirmphone id="confirm{{field.attributeName}}" #keyboardRef />
                  <i matSuffix class="material-icons mat-keyboard-icon"
                    (click)="openKeyboard('confirm' + field.attributeName)">keyboard</i>
                </div>
                <p *ngIf="showNotMatchedMessageEmail && (field.attributeName === contactTye) && field.attributeName === 'email' "
                  class="warning-message-for-contact">
                  {{langJson.enteredValuesNotMatch}}</p>
                <p *ngIf="showNotMatchedMessagePhone && (field.attributeName === contactTye) && field.attributeName === 'phone' "
                  class="warning-message-for-contact">
                  {{langJson.enteredValuesNotMatch}}</p>
              </div>
            </mat-grid-tile>
            <mat-grid-tile class="mat-form1">
              <div class="mini-card" *ngIf="field.tabgroup === 'contact' && field.controlType === 'textbox'">
                <mat-card-header></mat-card-header>
                <button class="contact-send-otp-btn"
                  [disabled]="sendOtpDisable || !(field.attributeName === contactTye)"
                  (click)="sendOTPBtn(field.attributeName)" mat-raised-button color="primary"
                  id="sendOTP{{field.attributeName}}">{{field.labelName[langCode][3]}}</button>
              </div>
            </mat-grid-tile>
          </mat-grid-list>
        </div>
      </mat-tab>
      <mat-tab label="{{'updatedemographic.languagePreference' | translate}}" class="language-card">
        <h3 class="tab-headings">{{'updatedemographic.languageHeading' | translate}}</h3>
        <div *ngFor="let field of schema['identity']; let i = index" dir="{{sitealignment}}">
          <div *ngIf="field.tabgroup === 'notificationLanguage' && field.controlType === 'dropdown'">
            <mat-grid-list *ngFor="let language of supportedLanguages;" [cols]="cols" rowHeight="100px"
              gutterSize="7px">
              <mat-grid-tile>
                <div class="mini-card"
                  *ngIf="field.tabgroup === 'notificationLanguage' && field.controlType === 'dropdown'">
                  <mat-card-header><mat-card-title>{{field.labelName[langCode][0]}}</mat-card-title></mat-card-header>
                  <span *ngIf="buildJSONData[field.attributeName]"><input style="border: none;" type="text"
                      class="readonly" readonly="true" disabled="true"
                      [value]="buildJSONData[field.attributeName].value"></span>
                </div>
              </mat-grid-tile>
              <mat-grid-tile>
                <div class="mini-card"
                  *ngIf="field.tabgroup === 'notificationLanguage' && field.controlType === 'dropdown'">
                  <mat-card-header><mat-card-title>{{field.labelName[langCode][1]}}</mat-card-title></mat-card-header>

                  <mat-select [placeholder]="field.placeHolder[langCode]" disableOptionCentering class="enable-dropdown"
                    [(ngModel)]="selected2" id="{{field.attributeName}}">
                    <mat-option *ngFor="let data of newNotificationLanguages"
                      (onSelectionChange)="capturePerfLang($event, field.attributeName)"
                      [value]="data.code">{{ data.name }}</mat-option>
                  </mat-select>
                </div>
              </mat-grid-tile>
            </mat-grid-list>
            <div style="text-align: end;margin-right: 2rem; margin-top: none;" *ngIf="langJson">
              <button mat-raised-button (click)="updatenotificationLanguage()" color="primary"
                id="submit">{{langJson.submit}}</button>
            </div>
          </div>
        </div>
      </mat-tab>
    </mat-tab-group>
  </mat-card>

  <mat-card style="padding: 16px;" *ngIf="showPreviewPage">
    <mat-card-subtitle style="font-size: 20px;" class="preview-heading">{{langJson.preview}}</mat-card-subtitle>
    <div class="identity-card">
      <mat-card-subtitle style="color: #000000; font-size: 14px;">{{matTabLabel}}</mat-card-subtitle>
      <button (click)="backBtn()" mat-button-toggle class="edit-btn">
        <img alt="" src="./assets/icons/iconfont/edit_black_24dp (2).svg" alt="" />
      </button>
    </div>
    <div class="table-main-card">
      <div [style.width]="width">
        <div class="input-values-main-card">
          <div>
            <table class="preview-input-size" *ngFor="let item of buildCloneJsonData">
              <tr *ngIf="typeOf(item.newData) !== 'string' && item.newData[0]">
                <td *ngIf="item.newData[0].value">{{item.labelName}}</td>
              </tr>
              <tr *ngIf="item.newData && typeOf(item.newData) === 'string'">
                <td>{{item.labelName}}</td>
              </tr>
              <tr *ngIf="typeOf(item.newData) !== 'string'">
                <td>
                  <span *ngFor="let eachLang of item.newData" style="margin-bottom: 5px;">
                    <input *ngIf="eachLang.value" style="margin-bottom: 5px; color: #000000;" type="text"
                      class="readonly" readonly="true" disabled="true" [value]="eachLang.value">
                  </span>
                </td>
              </tr>
              <tr *ngIf="typeOf(item.newData) === 'string' && item.newData">
                <td>
                  <input style="color: #000000;" type="text" class="readonly" readonly="true" disabled="true"
                    [value]="item.newData">
                </td>
              </tr>
            </table>
          </div>
        </div>
        <div class="files-list">
          <mat-card-title class="files-list-title">{{langJson.documentUploaded}}...</mat-card-title>
          <div style="width: 80%;">
            <div class="uploaded-single-file" *ngFor="let file of uploadedFiles; let i = index">
              <div class="file-icon" style="width: 50px">
                <svg version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg"
                  xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 58 58"
                  style="enable-background:new 0 0 58 58;" xml:space="preserve">
                  <polygon style="fill:#EDEADA;" points="51.5,14 37.5,0 6.5,0 6.5,58 51.5,58 " />
                  <g>
                    <path style="fill:#CEC9AE;"
                      d="M16.5,23h25c0.552,0,1-0.447,1-1s-0.448-1-1-1h-25c-0.552,0-1,0.447-1,1S15.948,23,16.5,23z" />
                    <path style="fill:#CEC9AE;"
                      d="M16.5,15h10c0.552,0,1-0.447,1-1s-0.448-1-1-1h-10c-0.552,0-1,0.447-1,1S15.948,15,16.5,15z" />
                    <path style="fill:#CEC9AE;"
                      d="M41.5,29h-25c-0.552,0-1,0.447-1,1s0.448,1,1,1h25c0.552,0,1-0.447,1-1S42.052,29,41.5,29z" />
                    <path style="fill:#CEC9AE;"
                      d="M41.5,37h-25c-0.552,0-1,0.447-1,1s0.448,1,1,1h25c0.552,0,1-0.447,1-1S42.052,37,41.5,37z" />
                    <path style="fill:#CEC9AE;"
                      d="M41.5,45h-25c-0.552,0-1,0.447-1,1s0.448,1,1,1h25c0.552,0,1-0.447,1-1S42.052,45,41.5,45z" />
                  </g>
                  <polygon style="fill:#CEC9AE;" points="37.5,0 37.5,14 51.5,14 " />
                </svg>
              </div>
              <div class="info">
                <h4 class="name">
                  {{ file?.name }}
                </h4>
                <p class="size">
                  {{ formatBytes(file?.size) }}
                </p>
                <app-progress [progress]="file?.progress"></app-progress>
              </div>

              <div class="preview">
                <img *ngIf="file.name !== selectedFileInPreviewPage" (click)="previewFileInPreviewPage(i)"
                  mat-card-xs-image style="margin: 0 0 -5px 0;" src='./assets/icons/iconfont/visibility_on.svg'
                  alt="" />
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="preview-agree-card">
      <div>
        <button *ngIf="updatingtype === 'identity' " [disabled]="((finalUserCloneData | keyvalue)?.length < 1)"
          (click)="updateBtn()" mat-raised-button color="primary">{{langJson.update}}</button>
        <button *ngIf="updatingtype === 'address' " [disabled]="((finalUserCloneData | keyvalue)?.length < 1)"
          (click)="updateBtn()" mat-raised-button color="primary">{{langJson.update}}</button>
      </div>
    </div>
  </mat-card>
</div>